window.addEventListener('load',initialize);var dynamicContentExecuted=false,scriptsLoaded=false;document.addEventListener("base-theme-scripts-loaded",function(e){scriptsLoaded=true;});(function(){function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;})();function initialize(){if(!dynamicContentExecuted){findDynamicContent();loadImmediateDynamicContent();attachScrollEvents();dynamicContentExecuted=true;}}
var allDynamicContent=document.querySelectorAll('[data-dynamic-content]'),dynamicContentOnLoad=[],dynamicContentOnScroll=[];function findDynamicContent(){for(var i=0,len=allDynamicContent.length;i<len;i++){var currentDynamicContent=allDynamicContent[i],attributes=currentDynamicContent.attributes,event='',templateName='',data='',values=false;for(var j=0;j<attributes.length;j++){switch(attributes[j].name){case'data-dynamic-values':values=attributes[j].value;break;case'data-dynamic-content':templateName=attributes[j].value;break;case'data-dynamic-content-load-event':event=attributes[j].value;break;}}
var templateObject={element:currentDynamicContent,template:templateName,values:values,event:event||'load'};switch(event){case'load':dynamicContentOnLoad.push(templateObject);break;case'scroll':templateObject.shown=false;dynamicContentOnScroll.push(templateObject);break;}}}
function loadImmediateDynamicContent(){if(dynamicContentOnLoad.length>0){for(var i=0;i<dynamicContentOnLoad.length;i++){getTemplates(dynamicContentOnLoad[i].template,applyTemplates,dynamicContentOnLoad[i]);}}}
function attachScrollEvents(){dynamicContentScroll();document.addEventListener('scroll',dynamicContentScroll);}
function dynamicContentScroll(e){for(var i=0;i<dynamicContentOnScroll.length;i++){if(!dynamicContentOnScroll[i].shown&&elementInViewport(dynamicContentOnScroll[i].element)){dynamicContentOnScroll[i].shown=true;getTemplates(dynamicContentOnScroll[i].template,applyTemplates,dynamicContentOnScroll[i]);}}}
function elementInViewport(el){var rect=el.getBoundingClientRect();return(((rect.top>=0&&rect.top<=(window.innerHeight||document.documentElement.clientHeight)+200)||(rect.bottom>=-200&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)))&&rect.right>=0);}
function getTemplates(templateNames,callback,originalTemplatesObject){if(!Array.isArray(templateNames)){templateNames=[templateNames];}
var xhr=new XMLHttpRequest();xhr.open('POST',(encodeURI(ajaxObject.url)+'?action=dynamic_content'),true);xhr.onload=function(){if(xhr.status===200){if(scriptsLoaded){callback(originalTemplatesObject,JSON.parse(xhr.responseText));}else{document.addEventListener("base-theme-scripts-loaded",function(){setTimeout(function(){callback(originalTemplatesObject,JSON.parse(xhr.responseText));},100);});}}else{console.error('Dynamic content request failed.  Returned status of '+xhr.status);}};xhr.setRequestHeader("Content-type","application/json; charset=utf-8");var payload={templates:templateNames,ID:ID,post:post,values:(typeof originalTemplatesObject.values!=undefined)?originalTemplatesObject.values:false,};var payloadString=JSON.stringify(payload);xhr.send(payloadString);}
function applyTemplates(originalTemplatesObject,receivedObject){var receivedTemplates=receivedObject.templates,receivedScripts=receivedObject.scripts;if(Array.isArray(receivedTemplates)){var willApplyDynamicContentEvent=new CustomEvent('apply-dynamic-content-start',{'cancelable':true,'bubbles':true});var doneApplyDynamicContentEvent=new CustomEvent('apply-dynamic-content-end',{'bubbles':true});var combinedArray=combineTemplateArrays(originalTemplatesObject,receivedTemplates);for(var i=0;i<combinedArray.length;i++){willApplyDynamicContentEvent.template=combinedArray[i].template;doneApplyDynamicContentEvent.template=combinedArray[i].template;var shouldBeCanceled=!combinedArray[i].element.dispatchEvent(willApplyDynamicContentEvent);if(!shouldBeCanceled){combinedArray[i].element.innerHTML=combinedArray[i].content;combinedArray[i].element.dispatchEvent(doneApplyDynamicContentEvent);}}
loadScripts(receivedScripts,true);}}
function combineTemplateArrays(arrayWithElements,arrayWithTemplates){var combined=[],search;if(!Array.isArray(arrayWithElements)){arrayWithElements=[arrayWithElements];}
while(search=arrayWithElements.pop()){for(var i=0;i<arrayWithTemplates.length;i++){if(arrayWithTemplates[i].template===search.template){search.content=arrayWithTemplates[i].content;}}
combined.push(search);}
return combined;}(function(window){var $q=function(q,res){if(document.querySelectorAll){res=document.querySelectorAll(q);}else{var d=document,a=d.styleSheets[0]||d.createStyleSheet();a.addRule(q,'f:b');for(var l=d.all,b=0,c=[],f=l.length;b<f;b++){l[b].currentStyle.f&&c.push(l[b]);}
a.removeRule(0);res=c;}
return res;},addEventListener=function(evt,fn){window.addEventListener?this.addEventListener(evt,fn,false):(window.attachEvent)?this.attachEvent('on'+evt,fn):this['on'+evt]=fn;};function loadImage(el){if(el.getAttribute('data-lazy-img')){var src=el.getAttribute('data-lazy-img');el.removeAttribute('data-lazy-img');el.setAttribute('src',src);}else if(el.getAttribute('data-lazy-srcset')){var srcset=el.getAttribute('data-lazy-srcset');el.removeAttribute('data-lazy-srcset');el.setAttribute('srcset',srcset);}else if(el.getAttribute('data-lazy-bg-img')){var src=el.getAttribute('data-lazy-bg-img'),currentStyle=el.getAttribute('style')||'',newStyle='';el.removeAttribute('data-lazy-bg-img');if(currentStyle.indexOf('url(')>0){newStyle=currentStyle.replace(/url\([^)]*\)/,'url('+src+')');}else{newStyle=currentStyle+'background-image:url('+src+');';}
el.setAttribute('style',newStyle)}}
function elementInViewport(el){var rect=el.getBoundingClientRect();return(((rect.top>=0&&rect.top<=(window.innerHeight||document.documentElement.clientHeight)+200)||(rect.bottom>=-200&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)))&&rect.right>=0);}
var processScroll=function(){for(var i=0,len=images.length;i<len;i++){if(images[i]&&elementInViewport(images[i])){var imageToLoad=images[i];images[i]=false;loadImage(imageToLoad);}}};var images=$q('img[data-lazy-img],*[data-lazy-bg-img]');processScroll();addEventListener('scroll',processScroll);document.addEventListener('apply-dynamic-content-end',function(){images=$q('img[data-lazy-img],*[data-lazy-bg-img]');})}(this));if(!document.cookie.indexOf('dpr=')&&document.cookie.indexOf('dpr=')!==0){var deviceRatio=window.devicePixelRatio,dateAfterAnYear=new Date(Date.now()+3600*1000*24*365*1);console.log(dateAfterAnYear);document.cookie='dpr='+deviceRatio+'; expires='+dateAfterAnYear.toGMTString();}console.log('Load vinilla functions');var FosVanilla={getClosest:function(elem,selector){if(!Element.prototype.matches){Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(s){var matches=(this.document||this.ownerDocument).querySelectorAll(s),i=matches.length;while(--i>=0&&matches.item(i)!==this){}
return i>-1;};}
for(;elem&&elem!==document;elem=elem.parentNode){if(elem.matches(selector))return elem;}
return null;},getElementsArray:function(selector){return Array.prototype.slice.call(document.querySelectorAll(selector));},};var ctaButtonsAnimation=function(){var ctaButtons=FosVanilla.getElementsArray('.cta-buttons');if(ctaButtons.length>0){ctaButtons.map(function(ctaButton){ctaButton.addEventListener('click',function(event){var ctaWrapElement=FosVanilla.getClosest(event.target,'.cta-buttons');if(ctaWrapElement.classList.contains('opened')){closeCTAButtons(ctaWrapElement);}else{openCTAButtons(ctaWrapElement);}});});var timeDelay=[];function openCTAButtons(ctaWrapElement){ctaWrapElement.classList.add('opened');ctaWrapElement.getElementsByClassName('cta-button')[0].classList.add('opened');ctaWrapElement.getElementsByClassName('close-cta-buttons')[0].classList.add('visible');if(!document.querySelector('body').classList.contains('hasOverlay')){FosVanilla.getElementsArray('.overlay').map(function(overlay,index){overlay.style.opacity=1;overlay.style.display='block';clearTimeout(timeDelay[index]);})
document.querySelector('body').classList.add('hasOverlay');}
ctaWrapElement.getElementsByClassName('open-cta-buttons')[0].classList.remove('visible');}
function closeCTAButtons(ctaWrapElement){ctaWrapElement.classList.remove('opened');ctaWrapElement.getElementsByClassName('cta-button')[0].classList.remove('opened');ctaWrapElement.getElementsByClassName('close-cta-buttons')[0].classList.remove('visible');if(document.querySelector('body').classList.contains('hasOverlay')){FosVanilla.getElementsArray('.overlay').map(function(overlay,index){overlay.style.opacity=0;timeDelay[index]=setTimeout(function(){overlay.style.display='none';},900);})
document.querySelector('body').classList.remove('hasOverlay');}
ctaWrapElement.getElementsByClassName('open-cta-buttons')[0].classList.add('visible');}}};var checkPricesAndAvailability=function(){var checkPricesForm=document.querySelectorAll('form.default-check-price-form');if(checkPricesForm.length>0){var isErrorLableClick=false;FosVanilla.getElementsArray('form.default-check-price-form input[type=submit]').map(function(el){el.disabled=false;FosVanilla.getClosest(el,'.submit-wrapper-with-loader').classList.remove('active');});FosVanilla.getElementsArray('form.default-check-price-form').map(function(priceCheckForm){priceCheckForm.addEventListener('submit',submitCheckPrice);postCodeField=priceCheckForm.getElementsByClassName('the-postfield')[0];postCodeField.addEventListener('focus',focusPostCodeInput)});document.querySelector('body').addEventListener('click',function(event){if(FosVanilla.getClosest(event.target,'.dynamic-helper')){var dynamicHelperParent=FosVanilla.getClosest(event.target,'.dynamic-helper'),inputPostCode=dynamicHelperParent.getElementsByClassName('the-postfield')[0];if(event.target.classList.contains('typewriter-box')||event.target.classList.contains('typewriter')){if(inputPostCode.value==''&&!inputPostCode.classList.contains('error')){dynamicHelperParent.classList.add('clicked');inputPostCode.focus();inputPostCode.addEventListener('blur',blurEffectInput);}}
if(event.target.classList.contains('error-message')&&event.target.parentNode.classList.contains('default-check-price-form')){event.preventDefault();event.target.classList.add('clicked');inputPostCode.focus();inputPostCode.addEventListener('blur',blurEffectInput);}else{FosVanilla.getElementsArray('form.default-check-price-form .error-message').map(function(errorMessage){errorMessage.classList.remove('clicked');});}}});function focusPostCodeInput(event){var inputPostCode=event.target,errorMessageClicked=FosVanilla.getClosest(inputPostCode,'.dynamic-helper').getElementsByClassName('error-message')[0];Array.prototype.slice.call(document.querySelectorAll('.dynamic-helper')).map(function(el){var inputCheck=el.getElementsByClassName('the-postfield')[0];if(el.classList.contains('clicked')&&inputCheck.value==''&&!inputCheck.classList.contains('error')){el.classList.remove('clicked');inputCheck.classList.remove('uppercase');}else if(inputCheck.classList.contains('error')&&inputCheck.value.replace(/\s/g,'')==''){if(inputPostCode.classList.contains('ls-postcode-field')&&inputCheck.classList.contains('ls-postcode-field')){inputCheck.classList.remove('ls-postcode-field');}else{removeErrors(el,inputCheck);}}});if(errorMessageClicked.classList.contains('clicked')){errorMessageClicked.classList.remove('clicked');errorMessageClicked.classList.add('visible');inputPostCode.classList.add('error');}
FosVanilla.getClosest(inputPostCode,'.dynamic-helper').classList.add('clicked');inputPostCode.addEventListener('blur',blurEffectInput);}
function submitCheckPrice(event){event.preventDefault();var inputPostCode=this.getElementsByClassName('the-postfield')[0],inputService=this.getElementsByClassName('the-selectfield')[0],dynamicHelper=FosVanilla.getClosest(this,'.dynamic-helper'),thePostCode=inputPostCode.value.trim(),theServiceField=0,postCodeRegex=/^([A-Z]{1,2})([0-9][0-9A-Z]?)\s*([0-9])([A-Z]{2})$/,hasErrors=false;if(inputService){theServiceField=inputService.value.trim();if(theServiceField==0){hasErrors=true;addErrors(dynamicHelper,inputService);}else{removeErrors(dynamicHelper,inputService,false);obfOptions['defaultServiceTypeId']=theServiceField;}}
if(thePostCode.toUpperCase().length>0&&postCodeRegex.test(thePostCode.toUpperCase())){removeErrors(dynamicHelper,inputPostCode,false);obfOptions['postCode']=thePostCode.replace(/\s/g,'');}else{hasErrors=true;addErrors(dynamicHelper,inputPostCode);inputPostCode.classList.add('ls-postcode-field');inputPostCode.focus();inputPostCode.addEventListener('blur',blurEffectInput);}
if(!hasErrors){var obfTriggerButton=document.querySelector('.trigger-book-btn');if(obfTriggerButton){obfTriggerButton.click();}else{obfTriggerButton=document.createElement("SPAN");obfTriggerButton.classList.add('trigger-book-btn');obfTriggerButton.setAttribute('data-book-btn','true');document.querySelector('body').appendChild(obfTriggerButton);document.querySelector('.trigger-book-btn').click();}
window.addEventListener('message',clearAll);}}
function addErrors(dynamicHelper,targetElement){var targetElementName=targetElement.name,targetErrorMessages=dynamicHelper.getElementsByTagName('LABEL'),targetErrorMessage='';for(var i=0;i<targetErrorMessages.length;i++){if(targetErrorMessages[i].htmlFor==targetElementName){targetErrorMessage=targetErrorMessages[i];}}
targetErrorMessage.classList.add('visible');targetErrorMessage.style.top='-'+(targetErrorMessage.offsetHeight+20)+'px';targetErrorMessage.style.left=(targetElement.parentElement.offsetWidth-targetErrorMessage.offsetWidth)/ 2+'px';targetElement.classList.add('error');}
function removeErrors(dynamicHelper,targetElement,showTheTypeWriter){var targetElementName=targetElement.name,targetErrorMessages=dynamicHelper.getElementsByTagName('LABEL'),targetErrorMessage='';for(var i=0;i<targetErrorMessages.length;i++){if(targetErrorMessages[i].htmlFor==targetElementName){targetErrorMessage=targetErrorMessages[i];}}
targetErrorMessage.classList.remove('visible');targetElement.classList.remove('error');if(showTheTypeWriter){dynamicHelper.classList.remove('clicked')}}
function clearAll(){if(event.data.action=='book-initialized'){FosVanilla.getElementsArray('.dynamic-helper').map(function(el){var postCodeInputClassList=el.getElementsByClassName('the-postfield')[0],serviceCodeInput=el.getElementsByClassName('the-selectfield')[0];el.classList.remove('clicked');postCodeInputClassList.classList.remove('uppercase');postCodeInputClassList.classList.remove('error');postCodeInputClassList.value='';el.getElementsByClassName('error-message')[0].classList.remove('visible');if(serviceCodeInput){serviceCodeInput.value='0';}});window.removeEventListener('message',clearAll)}}
function blurEffectInput(event){var dynamicHelper=FosVanilla.getClosest(this,'.dynamic-helper'),inputPostCode=dynamicHelper.getElementsByClassName('the-postfield')[0],inputService=dynamicHelper.getElementsByClassName('the-selectfield');if(inputPostCode.value==''){document.querySelector('body').addEventListener('click',checkBlurOut);inputPostCode.removeEventListener('blur',blurEffectInput);}
function checkBlurOut(event){if(!FosVanilla.getClosest(event.target,'.the-postfield-wrap')||!document.activeElement.classList.contains('the-postfield')||!event.target.classList.contains('the-submitfield')){if(inputPostCode.value.trim().length==0||!inputPostCode.classList.contains('error')){removeErrors(dynamicHelper,inputPostCode,true);if(inputService.length){removeErrors(dynamicHelper,inputService[0],false);}}}
this.removeEventListener('click',checkBlurOut);}}}}
document.addEventListener("DOMContentLoaded",function(){ctaButtonsAnimation();checkPricesAndAvailability();});